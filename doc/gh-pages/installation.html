<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Tempus" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

        <title>Tempus</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">

          <h1 id="project_title">Tempus</h1>

          <a href="index.html">About</a> | <a href="documentation.html">Documentation</a> | <a href="installation.html">Installation</a>

            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">

<h3>Installation</h3>


<h4>Compilation</h4>

<p>In the root directory, create a <code>build</code> directory and enter it</p>
<pre>
cmake .. && make </pre>

<p>You can launch <code>make install</code> (usually as root, with 'sudo' under Ubuntu) to install everything.</p>

<h4>Test database creation</h4>

<p>You can test the installation by running some unit tests. They need a test database. The needed steps to build it are :</p>
<ul>
<li>Create a postgreSQL database <code>tempus_test_db</code></li>
<li>Install PostGIS on it (<code>CREATE EXTENSION postgis;</code>)</<li>
<li>Populate it with the Tempus schema and test data: <code>psql tempus_test_db < data/tempus_test_db.sql</code></li>
</ul>

<h4>QGIS Plugin installation</h4>

<p>Just type <code>nmake install</code> (Windows) or <code>make install</code> (Linux) and it should install the plugin and all required dependencies to your local qgis plugin directory</p>

<p>When QGIs is launched, go to the "Extension management" dialog, look for "ifsttar routing plugin" and enable it.</p>

<h4>Server installation</h4>

<p>
The idea is to use the standalone mode of the WPS server and an httpd server (like nginx or Apache2) that
just "passes" execution to this executable.</p>

<p>You have to launch the "wps" executable from a command line, for example like this:</p>
<pre>
hme@socompa:~/build$ TEMPUS_DATA_DIRECTORY=../data/ ./bin/wps -c ./lib -p 9000 -l sample_multi_plugin -l sample_pt_plugin -l sample_road_plugin -t 4
</pre>

<p>Options used:</p>
<ul>
<li><b>-c ./lib</b>: will start the server in the given directory, where plugins (.so files) are located</li>
<li><b>-l plugin</b>: will load the given plugin</li>
<li><b>-t 4</b>: number of threads to use for parallel request handling</li>
<li>The option <b>-d "options"</b> would also allow to specify how to connect to the underlying database (default to "dbname=tempus_test_db").</li>
</ul>

<p>
This will create a listening socket on port 9000 and start a WPS server.
This way, you can see debugging outputs.
</p>

<p>The WPS server also has a "daemon" mode. Refer to the file <code>script/wps</code> for an example of use.</p>

<h5>Apache configuration</h5>

<p>Download apache2 and mod_fastcgi or install package libapache2-mod-fastcgi (Ubuntu).</p>

<p>After installation, within the Apache2 configuration directory (/etc/apache2 under Linux), check that the fastcgi module is correctly loaded. A link to <code>mods-available/mod_fastcgi.conf</code> must exist in <code>mods-enabled</code>.

<p>Then this file must have the following first line :</p>
<pre>
FastCgiExternalServer /var/www/wps -host 127.0.0.1:9000</pre>

<p>Restart the Apache server.
You can now test the WPS installation with a browser pointing to <a href="http://127.0.0.1/wps?service=wps&version=1.0.0&request=GetCapabilities">http://127.0.0.1/wps?service=wps&version=1.0.0&request=GetCapabilities</a></p>

<h5>nginx configuration</h5>

<p>
On Windows, nginx can be downloaded from http://nginx.org/en/download.html. Just unzip it wherever you like. On Ubuntu you can install the package nginx.</p>

<p>You can now configure nginx, by adding the following lines inside the <code>server {...}</code> configuration part of nginx.conf (/etc/nginx/sites-available/default on Ubuntu)</p>
<pre>
location /wps {
        include fastcgi_params;
        fastcgi_pass 127.0.0.1:9000;
}
</pre>
		
<p>nginx has normally to be launched only once.</p>

<h4>Windows</h4>

<p>A Windows installer is provided. It will handle the installation of every Tempus components, including PostgreSQL/PostGIS and QGIS if needed.</p>

<img src="images/windows_install_animation.gif"/>

<p>(<a href="images/windows_install_steps.zip">Source images</a> of the animation)</p>

<h4>Unit tests</h4>

<p>You can test your installation by running some unit tests. Within the <code>build</code> directory, you can run <code>ctest</code> in order to test the core components. Example of output:</p>

<pre>~/src/TempusV2/build$ ctest
Test project /home/hme/src/TempusV2/build
    Start 1: test_core
1/3 Test #1: test_core ........................   Passed    8.00 sec
    Start 2: test_osm2shp
2/3 Test #2: test_osm2shp .....................   Passed    0.06 sec
    Start 3: test_osm2shp++
3/3 Test #3: test_osm2shp++ ...................   Passed    0.08 sec

100% tests passed, 0 tests failed out of 3

Total Test time (real) =   8.15 sec
</pre>

<p>In order to test the WPS and Python parts, you can run the Python script <code>test_wps.py</code> (a WPS with all the sample plugins loaded must be available on 127.0.0.1/wps). Example of output:</p>
<pre>
~/src/TempusV2/src/tests$ python test_wps.py 
........
----------------------------------------------------------------------
Ran 8 tests in 3.497s

OK
</pre>

      </section>
    </div>

  </body>
</html>
